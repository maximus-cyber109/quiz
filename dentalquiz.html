<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PB DAYS: Pulse Edition - Neon Quiz Challenge</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@thumbmarkjs/thumbmarkjs/dist/thumbmark.umd.js"></script>
<style>
    .quiz-wrapper {
        all: initial;
        font-family: 'Exo 2', sans-serif;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #0a0a0a 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        position: relative;
        overflow-x: hidden;
    }

    .quiz-wrapper::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
            radial-gradient(circle at 20% 20%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 80%, rgba(255, 0, 255, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 50% 50%, rgba(0, 255, 0, 0.05) 0%, transparent 50%);
        animation: bgPulse 4s ease-in-out infinite alternate;
        pointer-events: none;
    }

    @keyframes bgPulse {
        0% { opacity: 0.3; }
        100% { opacity: 0.7; }
    }

    .quiz-wrapper * {
        box-sizing: border-box;
    }

    .quiz-container {
        background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        backdrop-filter: blur(20px);
        border: 2px solid rgba(255,255,255,0.2);
        border-radius: 25px;
        box-shadow: 
            0 25px 50px rgba(0,0,0,0.5),
            inset 0 1px 0 rgba(255,255,255,0.3),
            0 0 50px rgba(0,255,255,0.2);
        padding: 40px;
        max-width: 1000px;
        width: 100%;
        position: relative;
        overflow: hidden;
        transform-style: preserve-3d;
        animation: containerFloat 6s ease-in-out infinite;
    }

    @keyframes containerFloat {
        0%, 100% { transform: translateY(0px) rotateX(0deg); }
        50% { transform: translateY(-10px) rotateX(1deg); }
    }

    .quiz-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    /* EPIC NEON TITLE */
    .neon-header {
        text-align: center;
        margin-bottom: 40px;
        perspective: 1000px;
    }

    .neon-title {
        font-family: 'Orbitron', monospace;
        font-size: 4rem;
        font-weight: 900;
        color: #fff;
        text-transform: uppercase;
        letter-spacing: 5px;
        margin: 0;
        position: relative;
        display: inline-block;
        text-shadow: 
            0 0 5px #fff,
            0 0 10px #fff,
            0 0 15px #00ffff,
            0 0 20px #00ffff,
            0 0 25px #00ffff,
            0 0 30px #00ffff,
            0 0 35px #00ffff,
            0 0 40px #00ffff;
        animation: neonGlow 2s ease-in-out infinite alternate, neonFloat 3s ease-in-out infinite;
        transform-style: preserve-3d;
    }

    @keyframes neonGlow {
        0% {
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 15px #00ffff,
                0 0 20px #00ffff,
                0 0 25px #00ffff,
                0 0 30px #00ffff,
                0 0 35px #00ffff,
                0 0 40px #00ffff;
        }
        100% {
            text-shadow: 
                0 0 10px #fff,
                0 0 20px #fff,
                0 0 30px #00ffff,
                0 0 40px #00ffff,
                0 0 50px #00ffff,
                0 0 60px #00ffff,
                0 0 70px #00ffff,
                0 0 80px #00ffff;
        }
    }

    @keyframes neonFloat {
        0%, 100% { transform: translateZ(0px) rotateY(0deg); }
        50% { transform: translateZ(20px) rotateY(2deg); }
    }

    .pulse-edition {
        font-family: 'Orbitron', monospace;
        font-size: 1.8rem;
        font-weight: 400;
        color: #ff00ff;
        text-shadow: 
            0 0 5px #ff00ff,
            0 0 10px #ff00ff,
            0 0 15px #ff00ff,
            0 0 20px #ff00ff;
        animation: pulseGlow 1.5s ease-in-out infinite alternate;
        margin-top: 10px;
    }

    @keyframes pulseGlow {
        0% { opacity: 0.7; transform: scale(1); }
        100% { opacity: 1; transform: scale(1.05); }
    }

    .event-dates {
        font-size: 1.2rem;
        color: #00ff00;
        text-shadow: 0 0 10px #00ff00;
        margin: 10px 0;
        animation: dateFlicker 3s infinite;
    }

    @keyframes dateFlicker {
        0%, 90%, 100% { opacity: 1; }
        95% { opacity: 0.7; }
    }

    .tagline {
        font-size: 1rem;
        color: #ffff00;
        text-shadow: 0 0 8px #ffff00;
        font-weight: 600;
        letter-spacing: 2px;
        margin: 15px 0;
        animation: taglinePulse 2s ease-in-out infinite;
    }

    @keyframes taglinePulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.02); }
    }

    /* LIVE COUNTER */
    .live-counter {
        background: linear-gradient(145deg, rgba(0,255,0,0.2), rgba(0,200,0,0.1));
        border: 2px solid rgba(0,255,0,0.5);
        border-radius: 20px;
        padding: 15px 25px;
        color: #00ff00;
        font-weight: 700;
        text-shadow: 0 0 10px #00ff00;
        display: inline-block;
        margin: 20px 0;
        animation: counterPulse 2s ease-in-out infinite;
        box-shadow: 0 0 20px rgba(0,255,0,0.3);
    }

    @keyframes counterPulse {
        0%, 100% { box-shadow: 0 0 20px rgba(0,255,0,0.3); }
        50% { box-shadow: 0 0 30px rgba(0,255,0,0.6); }
    }

    /* 3D BUTTONS */
    .btn-3d {
        background: linear-gradient(145deg, #667eea, #764ba2);
        border: none;
        border-radius: 20px;
        padding: 18px 35px;
        color: white;
        font-size: 1.2rem;
        font-weight: 700;
        cursor: pointer;
        position: relative;
        transform-style: preserve-3d;
        transition: all 0.3s ease;
        box-shadow: 
            0 8px 15px rgba(0,0,0,0.3),
            inset 0 1px 0 rgba(255,255,255,0.3),
            0 0 20px rgba(102,126,234,0.4);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin: 10px;
        text-decoration: none;
        display: inline-block;
        text-align: center;
    }

    .btn-3d:hover {
        transform: translateY(-5px) rotateX(10deg);
        box-shadow: 
            0 15px 25px rgba(0,0,0,0.4),
            inset 0 1px 0 rgba(255,255,255,0.4),
            0 0 30px rgba(102,126,234,0.6);
    }

    .btn-3d:active {
        transform: translateY(-2px) rotateX(5deg);
    }

    .btn-neon {
        background: linear-gradient(145deg, transparent, rgba(0,255,255,0.1));
        border: 2px solid #00ffff;
        color: #00ffff;
        text-shadow: 0 0 10px #00ffff;
        box-shadow: 
            0 0 20px rgba(0,255,255,0.4),
            inset 0 0 20px rgba(0,255,255,0.1);
    }

    .btn-neon:hover {
        background: linear-gradient(145deg, rgba(0,255,255,0.1), rgba(0,255,255,0.2));
        box-shadow: 
            0 0 30px rgba(0,255,255,0.6),
            inset 0 0 30px rgba(0,255,255,0.2);
        color: #ffffff;
        text-shadow: 0 0 15px #00ffff;
    }

    /* QUIZ ELEMENTS */
    .quiz-card {
        background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255,255,255,0.2);
        border-radius: 20px;
        padding: 30px;
        margin: 20px 0;
        box-shadow: 
            0 15px 25px rgba(0,0,0,0.2),
            inset 0 1px 0 rgba(255,255,255,0.2);
        animation: cardFloat 4s ease-in-out infinite;
    }

    @keyframes cardFloat {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-5px); }
    }

    .timer-display {
        background: linear-gradient(145deg, #ff6b6b, #ee5a52);
        color: white;
        padding: 15px 30px;
        border-radius: 25px;
        font-size: 1.8rem;
        font-weight: 900;
        text-align: center;
        box-shadow: 
            0 10px 20px rgba(255,107,107,0.4),
            inset 0 1px 0 rgba(255,255,255,0.3);
        animation: timerPulse 1s ease-in-out infinite;
        margin: 20px auto;
        display: inline-block;
    }

    @keyframes timerPulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    .question-card {
        background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
        border: 2px solid rgba(255,255,255,0.2);
        border-radius: 15px;
        padding: 25px;
        margin: 15px 0;
        color: white;
        font-size: 1.4rem;
        line-height: 1.6;
        transform-style: preserve-3d;
        transition: all 0.3s ease;
    }

    .option-3d {
        background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
        border: 2px solid rgba(255,255,255,0.2);
        border-radius: 15px;
        padding: 20px;
        margin: 12px 0;
        cursor: pointer;
        transition: all 0.3s ease;
        transform-style: preserve-3d;
        color: white;
        font-size: 1.1rem;
        position: relative;
        overflow: hidden;
    }

    .option-3d::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        transition: left 0.5s ease;
    }

    .option-3d:hover {
        transform: translateY(-3px) rotateX(5deg);
        border-color: #00ffff;
        box-shadow: 
            0 10px 20px rgba(0,0,0,0.3),
            0 0 20px rgba(0,255,255,0.4);
    }

    .option-3d:hover::before {
        left: 100%;
    }

    .option-3d.selected {
        background: linear-gradient(145deg, #00ffff, #0088cc);
        border-color: #00ffff;
        transform: translateY(-5px) rotateX(8deg);
        box-shadow: 
            0 15px 25px rgba(0,0,0,0.4),
            0 0 30px rgba(0,255,255,0.6);
    }

    .option-3d.correct {
        background: linear-gradient(145deg, #00ff00, #00cc00);
        border-color: #00ff00;
        box-shadow: 0 0 30px rgba(0,255,0,0.6);
    }

    .option-3d.incorrect {
        background: linear-gradient(145deg, #ff0000, #cc0000);
        border-color: #ff0000;
        box-shadow: 0 0 30px rgba(255,0,0,0.6);
    }

    .progress-3d {
        width: 100%;
        height: 12px;
        background: rgba(255,255,255,0.2);
        border-radius: 10px;
        overflow: hidden;
        margin: 20px 0;
        box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
    }

    .progress-fill-3d {
        height: 100%;
        background: linear-gradient(90deg, #00ffff, #ff00ff, #ffff00);
        width: 0%;
        transition: width 0.5s ease;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0,255,255,0.6);
        animation: progressGlow 2s ease-in-out infinite alternate;
    }

    @keyframes progressGlow {
        0% { box-shadow: 0 0 20px rgba(0,255,255,0.6); }
        100% { box-shadow: 0 0 30px rgba(0,255,255,0.9); }
    }

    /* RESULTS SCREEN */
    .results-3d {
        text-align: center;
        animation: resultsEntrance 1s ease-out;
    }

    @keyframes resultsEntrance {
        0% { opacity: 0; transform: translateY(50px) rotateX(-20deg); }
        100% { opacity: 1; transform: translateY(0) rotateX(0deg); }
    }

    .trophy-3d {
        font-size: 5rem;
        color: #ffd700;
        text-shadow: 
            0 0 20px #ffd700,
            0 0 40px #ffd700;
        animation: trophySpin 3s ease-in-out infinite;
        margin: 20px 0;
    }

    @keyframes trophySpin {
        0%, 100% { transform: rotateY(0deg) scale(1); }
        50% { transform: rotateY(180deg) scale(1.1); }
    }

    .score-3d {
        font-size: 2.5rem;
        font-weight: 900;
        color: #00ffff;
        text-shadow: 
            0 0 10px #00ffff,
            0 0 20px #00ffff;
        margin: 20px 0;
        animation: scoreGlow 2s ease-in-out infinite alternate;
    }

    @keyframes scoreGlow {
        0% { transform: scale(1); }
        100% { transform: scale(1.05); }
    }

    .reward-3d {
        background: linear-gradient(145deg, rgba(255,215,0,0.2), rgba(255,165,0,0.1));
        border: 2px solid #ffd700;
        border-radius: 20px;
        padding: 30px;
        margin: 30px 0;
        color: #ffd700;
        text-shadow: 0 0 10px #ffd700;
        box-shadow: 
            0 20px 40px rgba(0,0,0,0.3),
            0 0 40px rgba(255,215,0,0.3);
        animation: rewardFloat 3s ease-in-out infinite;
    }

    @keyframes rewardFloat {
        0%, 100% { transform: translateY(0px) rotateZ(0deg); }
        50% { transform: translateY(-10px) rotateZ(1deg); }
    }

    .coupon-3d {
        background: linear-gradient(145deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
        border: 3px dashed #00ffff;
        border-radius: 15px;
        padding: 20px;
        font-size: 2rem;
        font-weight: 900;
        color: #00ffff;
        text-shadow: 0 0 15px #00ffff;
        letter-spacing: 3px;
        margin: 20px 0;
        animation: couponGlow 1.5s ease-in-out infinite alternate;
    }

    @keyframes couponGlow {
        0% { box-shadow: 0 0 20px rgba(0,255,255,0.4); }
        100% { box-shadow: 0 0 40px rgba(0,255,255,0.8); }
    }

    /* MOBILE RESPONSIVE */
    @media (max-width: 768px) {
        .quiz-container {
            padding: 20px;
            margin: 10px;
        }
        
        .neon-title {
            font-size: 2.5rem;
            letter-spacing: 2px;
        }
        
        .pulse-edition {
            font-size: 1.2rem;
        }
        
        .btn-3d {
            width: 100%;
            margin: 8px 0;
        }
    }

    /* HIDDEN STATES */
    .hidden { display: none !important; }
    .show { display: block !important; }

    /* FLOATING PARTICLES */
    .particle {
        position: absolute;
        width: 3px;
        height: 3px;
        background: #00ffff;
        border-radius: 50%;
        box-shadow: 0 0 10px #00ffff;
        animation: float 6s ease-in-out infinite;
        opacity: 0.7;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px) translateX(0px); }
        33% { transform: translateY(-20px) translateX(10px); }
        66% { transform: translateY(-10px) translateX(-10px); }
    }

    /* TRIES INDICATOR */
    .tries-indicator {
        background: linear-gradient(145deg, rgba(255,0,255,0.2), rgba(200,0,200,0.1));
        border: 2px solid #ff00ff;
        border-radius: 15px;
        padding: 10px 20px;
        color: #ff00ff;
        text-shadow: 0 0 8px #ff00ff;
        font-weight: 700;
        margin: 15px 0;
        display: inline-block;
        animation: triesGlow 2s ease-in-out infinite alternate;
    }

    @keyframes triesGlow {
        0% { box-shadow: 0 0 15px rgba(255,0,255,0.3); }
        100% { box-shadow: 0 0 25px rgba(255,0,255,0.6); }
    }
</style>

<div class="quiz-wrapper">
    <!-- Floating Particles -->
    <div class="particle" style="top: 10%; left: 10%; animation-delay: 0s;"></div>
    <div class="particle" style="top: 20%; right: 20%; animation-delay: 1s;"></div>
    <div class="particle" style="bottom: 30%; left: 30%; animation-delay: 2s;"></div>
    <div class="particle" style="bottom: 20%; right: 10%; animation-delay: 3s;"></div>
    <div class="particle" style="top: 50%; left: 5%; animation-delay: 4s;"></div>
    <div class="particle" style="top: 70%; right: 15%; animation-delay: 5s;"></div>

    <div class="quiz-container">
        <!-- Epic Neon Header -->
        <div class="neon-header">
            <h1 class="neon-title">PB DAYS</h1>
            <div class="pulse-edition">PULSE EDITION</div>
            <div class="event-dates">12-14 August 2025</div>
            <div class="tagline">ðŸŽ¯ SUPERDEALS â€¢ ðŸ§  QUIZZES â€¢ ðŸ’° DAILY JACKPOTS</div>
            <div class="live-counter" id="liveCounter">
                <i class="fas fa-users"></i> <span id="playerCount">0</span> players online!
            </div>
            <div class="tries-indicator" id="triesIndicator">
                <i class="fas fa-star"></i> <span id="triesLeft">2</span> tries remaining
            </div>
        </div>

        <!-- Start Screen -->
        <div id="startScreen" class="show">
            <div class="quiz-card">
                <h2 style="color: #00ffff; font-size: 2rem; text-shadow: 0 0 15px #00ffff; text-align: center; margin-bottom: 25px;">
                    <i class="fas fa-tooth"></i> DENTAL MASTERY CHALLENGE
                </h2>
                <div style="color: white; font-size: 1.2rem; text-align: center; margin-bottom: 30px;">
                    Test your dental expertise and unlock exclusive PB DAYS rewards!
                </div>
                
                <div class="quiz-card" style="background: linear-gradient(145deg, rgba(0,255,255,0.1), rgba(0,200,200,0.05));">
                    <h3 style="color: #00ffff; margin-bottom: 20px;">
                        <i class="fas fa-info-circle"></i> CHALLENGE RULES:
                    </h3>
                    <ul style="color: white; list-style: none; padding: 0;">
                        <li style="margin: 10px 0; padding-left: 30px; position: relative;">
                            <span style="position: absolute; left: 0; color: #00ff00;">âœ“</span>
                            10 randomly selected dental questions
                        </li>
                        <li style="margin: 10px 0; padding-left: 30px; position: relative;">
                            <span style="position: absolute; left: 0; color: #00ff00;">âœ“</span>
                            5 minutes to complete the challenge
                        </li>
                        <li style="margin: 10px 0; padding-left: 30px; position: relative;">
                            <span style="position: absolute; left: 0; color: #00ff00;">âœ“</span>
                            Higher scores unlock better rewards
                        </li>
                        <li style="margin: 10px 0; padding-left: 30px; position: relative;">
                            <span style="position: absolute; left: 0; color: #00ff00;">âœ“</span>
                            2 attempts per player
                        </li>
                        <li style="margin: 10px 0; padding-left: 30px; position: relative;">
                            <span style="position: absolute; left: 0; color: #00ff00;">âœ“</span>
                            Exclusive PB DAYS rewards await!
                        </li>
                    </ul>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-3d btn-neon" onclick="startQuiz()" style="font-size: 1.4rem; padding: 22px 45px;">
                        <i class="fas fa-rocket"></i> LAUNCH CHALLENGE
                    </button>
                </div>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quizScreen" class="hidden">
            <div style="text-align: center; margin-bottom: 25px;">
                <div class="timer-display" id="timer">
                    <i class="fas fa-clock"></i> 5:00
                </div>
            </div>

            <div class="progress-3d">
                <div class="progress-fill-3d" id="progressBar"></div>
            </div>

            <div class="question-card">
                <div style="color: #00ffff; font-weight: 700; margin-bottom: 15px;" id="questionNumber">
                    Question 1 of 10
                </div>
                <div id="questionText" style="font-size: 1.5rem; line-height: 1.6;"></div>
            </div>

            <div id="optionsContainer">
                <!-- Options will be dynamically added here -->
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn-3d" id="nextBtn" onclick="nextQuestion()" disabled>
                    NEXT QUESTION <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="resultsScreen" class="hidden">
            <div class="results-3d">
                <div class="trophy-3d">
                    <i class="fas fa-trophy"></i>
                </div>
                <h2 style="color: #ffd700; font-size: 3rem; text-shadow: 0 0 20px #ffd700; margin: 20px 0;" id="resultsTitle">
                    MISSION COMPLETE!
                </h2>
                <div class="score-3d" id="scoreDisplay"></div>
                
                <div class="reward-3d" id="rewardCard">
                    <h3 style="margin-bottom: 20px; font-size: 1.8rem;">
                        <i class="fas fa-gift"></i> YOUR PB DAYS REWARD!
                    </h3>
                    <p id="rewardText" style="font-size: 1.3rem; margin-bottom: 25px;"></p>
                    <div class="coupon-3d" id="couponCode"></div>
                    <button class="btn-3d" onclick="copyCoupon()" style="margin: 10px;">
                        <i class="fas fa-copy"></i> COPY CODE
                    </button>
                </div>
                
                <div style="margin-top: 40px;">
                    <a href="https://pinkblue.in/cart" class="btn-3d" target="_blank" style="background: linear-gradient(145deg, #28a745, #20c997); margin: 8px;">
                        <i class="fas fa-shopping-cart"></i> CHECKOUT NOW
                    </a>
                    <a href="https://pinkblue.in" class="btn-3d" target="_blank" style="background: linear-gradient(145deg, #ffc107, #fd7e14); margin: 8px;">
                        <i class="fas fa-store"></i> CONTINUE SHOPPING
                    </a>
                    <button class="btn-3d btn-neon" onclick="shareQuiz()" style="margin: 8px;">
                        <i class="fas fa-share-alt"></i> SHARE VICTORY
                    </button>
                    <button class="btn-3d" onclick="restartQuiz()" style="margin: 8px;" id="restartBtn">
                        <i class="fas fa-redo"></i> TRY AGAIN
                    </button>
                </div>
            </div>
        </div>

        <!-- Creative Footer -->
        <div style="margin-top: 40px; padding: 25px; background: linear-gradient(145deg, rgba(255,0,255,0.1), rgba(255,100,255,0.05)); border-radius: 20px; text-align: center; color: #ff00ff; border: 1px solid rgba(255,0,255,0.3);">
            <p style="font-size: 1.1rem; font-style: italic; margin: 0;">
                ðŸ¦· "Life's too short for dull teeth... and boring quizzes!" âš¡
            </p>
            <small style="opacity: 0.8; margin-top: 10px; display: block;">
                Powered by PinkBlue.in - Where dental dreams get an upgrade! âœ¨
            </small>
        </div>
    </div>
</div>

<script>
    // Advanced Fingerprinting System
    class AdvancedFingerprint {
        constructor() {
            this.tm = new ThumbmarkJS.Thumbmark();
        }
        
        async generateFingerprint() {
            try {
                const result = await this.tm.get();
                return result.id;
            } catch (error) {
                // Fallback fingerprinting
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillText('PBDaysNeon2025', 2, 2);
                
                const fingerprint = canvas.toDataURL() + 
                                   navigator.userAgent + 
                                   screen.width + 
                                   screen.height + 
                                   navigator.language +
                                   navigator.platform +
                                   (navigator.hardwareConcurrency || '');
                
                let hash = 0;
                for (let i = 0; i < fingerprint.length; i++) {
                    const char = fingerprint.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return Math.abs(hash).toString();
            }
        }
        
        async getAttempts() {
            const fp = await this.generateFingerprint();
            const attempts = JSON.parse(localStorage.getItem('pbDaysAttempts') || '{}');
            return attempts[fp] || 0;
        }
        
        async incrementAttempts() {
            const fp = await this.generateFingerprint();
            const attempts = JSON.parse(localStorage.getItem('pbDaysAttempts') || '{}');
            attempts[fp] = (attempts[fp] || 0) + 1;
            localStorage.setItem('pbDaysAttempts', JSON.stringify(attempts));
            return attempts[fp];
        }
    }

    // Quiz Variables
    let currentQuestion = 0;
    let score = 0;
    let timeLeft = 300; // 5 minutes in seconds
    let timer;
    let selectedAnswer = null;
    let questions = [];
    let fingerprint = new AdvancedFingerprint();
    let attemptsUsed = 0;

    // Intelligent Player Counter
    class PlayerCounter {
        constructor() {
            this.baseCount = 847;
            this.lastUpdate = Date.now();
            this.trend = 1; // 1 for increasing, -1 for decreasing
            this.init();
        }
        
        init() {
            const stored = localStorage.getItem('pbDaysPlayerData');
            if (stored) {
                const data = JSON.parse(stored);
                this.baseCount = data.count;
                this.lastUpdate = data.timestamp;
            }
            this.updateCounter();
            setInterval(() => this.updateCounter(), 3000 + Math.random() * 4000);
        }
        
        updateCounter() {
            const now = Date.now();
            const timeDiff = (now - this.lastUpdate) / 1000 / 60; // minutes
            
            // Realistic increment based on time of day (IST)
            const hour = new Date().getHours();
            let baseIncrement = 0;
            
            if (hour >= 9 && hour <= 12) baseIncrement = 3; // Morning peak
            else if (hour >= 14 && hour <= 18) baseIncrement = 5; // Afternoon peak
            else if (hour >= 19 && hour <= 22) baseIncrement = 4; // Evening peak
            else baseIncrement = 1; // Off-peak
            
            // Add some randomness
            const increment = Math.floor(Math.random() * baseIncrement) + 1;
            
            // Occasionally decrease for realism
            if (Math.random() < 0.15) {
                this.baseCount = Math.max(150, this.baseCount - Math.floor(Math.random() * 3));
            } else {
                this.baseCount += increment;
            }
            
            // Cap at 1000
            if (this.baseCount > 1000) {
                this.baseCount = 150 + Math.floor(Math.random() * 50);
            }
            
            document.getElementById('playerCount').textContent = this.baseCount;
            this.lastUpdate = now;
            
            // Save to localStorage
            localStorage.setItem('pbDaysPlayerData', JSON.stringify({
                count: this.baseCount,
                timestamp: this.lastUpdate
            }));
        }
    }

    const playerCounter = new PlayerCounter();

    // Questions Pool
    const allQuestions = [
        {
            question: "What is the hardest substance in the human body?",
            options: ["Bone", "Tooth enamel", "Dentin", "Cartilage"],
            correct: 1
        },
        {
            question: "How many permanent teeth does an adult typically have?",
            options: ["28", "30", "32", "34"],
            correct: 2
        },
        {
            question: "What is the most common dental disease?",
            options: ["Gingivitis", "Tooth decay (caries)", "Periodontal disease", "Oral cancer"],
            correct: 1
        },
        {
            question: "Which mineral is primarily responsible for strengthening tooth enamel?",
            options: ["Calcium", "Phosphorus", "Fluoride", "Magnesium"],
            correct: 2
        },
        {
            question: "What is the technical term for teeth grinding?",
            options: ["Bruxism", "Gingivitis", "Periodontitis", "Xerostomia"],
            correct: 0
        },
        {
            question: "At what age do children typically start losing their baby teeth?",
            options: ["4-5 years", "6-7 years", "8-9 years", "10-11 years"],
            correct: 1
        },
        {
            question: "What is the soft tissue inside the tooth called?",
            options: ["Enamel", "Dentin", "Pulp", "Cementum"],
            correct: 2
        },
        {
            question: "How often should you replace your toothbrush?",
            options: ["Every month", "Every 3-4 months", "Every 6 months", "Every year"],
            correct: 1
        },
        {
            question: "What is the ideal pH level for maintaining oral health?",
            options: ["5.5", "6.0", "7.0", "7.5"],
            correct: 2
        },
        {
            question: "Which type of bacteria is primarily responsible for tooth decay?",
            options: ["Streptococcus mutans", "Lactobacillus", "Actinomyces", "Prevotella"],
            correct: 0
        },
        {
            question: "What is the recommended fluoride concentration in toothpaste for adults?",
            options: ["500 ppm", "1000 ppm", "1450 ppm", "2000 ppm"],
            correct: 2
        },
        {
            question: "Which tooth is known as the 'wisdom tooth'?",
            options: ["First molar", "Second molar", "Third molar", "Premolar"],
            correct: 2
        },
        {
            question: "What causes bad breath (halitosis) most commonly?",
            options: ["Poor oral hygiene", "Stomach problems", "Lung disease", "Heart disease"],
            correct: 0
        },
        {
            question: "How long should you brush your teeth?",
            options: ["30 seconds", "1 minute", "2 minutes", "5 minutes"],
            correct: 2
        },
        {
            question: "What is dental plaque primarily composed of?",
            options: ["Food particles", "Bacteria", "Saliva", "Dead cells"],
            correct: 1
        },
        {
            question: "Which vitamin deficiency can cause bleeding gums?",
            options: ["Vitamin A", "Vitamin B", "Vitamin C", "Vitamin D"],
            correct: 2
        },
        {
            question: "What is the space between teeth called?",
            options: ["Interdental space", "Diastema", "Embrasure", "Frenum"],
            correct: 0
        },
        {
            question: "Which professional treatment removes tartar?",
            options: ["Scaling", "Polishing", "Whitening", "Bonding"],
            correct: 0
        },
        {
            question: "What does 'RCT' stand for in dentistry?",
            options: ["Root Canal Therapy", "Routine Check Treatment", "Rapid Care Treatment", "Root Cavity Treatment"],
            correct: 0
        },
        {
            question: "What is the main function of saliva?",
            options: ["Digestion only", "Lubrication and protection", "Taste enhancement", "Temperature regulation"],
            correct: 1
        },
        {
            question: "How many baby teeth do children typically have?",
            options: ["16", "20", "24", "28"],
            correct: 1
        },
        {
            question: "What is periodontal disease?",
            options: ["Tooth decay", "Gum disease", "Oral cancer", "Tooth grinding"],
            correct: 1
        },
        {
            question: "Which tool is used to measure pocket depth around teeth?",
            options: ["Scaler", "Probe", "Curette", "Explorer"],
            correct: 1
        },
        {
            question: "What is xerostomia?",
            options: ["Excessive saliva", "Dry mouth", "Gum bleeding", "Tooth sensitivity"],
            correct: 1
        },
        {
            question: "At what age should children first visit a dentist?",
            options: ["When first tooth appears", "At 1 year old", "At 2 years old", "At 3 years old"],
            correct: 1
        },
        {
            question: "What is the crown of a tooth?",
            options: ["The root", "The visible part above the gum", "The nerve", "The bone socket"],
            correct: 1
        },
        {
            question: "Which material is commonly used for white fillings?",
            options: ["Amalgam", "Gold", "Composite resin", "Silver"],
            correct: 2
        },
        {
            question: "What is the purpose of dental floss?",
            options: ["Whiten teeth", "Remove plaque between teeth", "Strengthen enamel", "Freshen breath"],
            correct: 1
        },
        {
            question: "How often should you visit the dentist for routine checkups?",
            options: ["Every 3 months", "Every 6 months", "Once a year", "Only when problems occur"],
            correct: 1
        },
        {
            question: "What is gingivitis?",
            options: ["Tooth decay", "Gum inflammation", "Oral cancer", "Tooth loss"],
            correct: 1
        }
    ];

    // Quiz Functions
    function getRandomQuestions(pool, count = 10) {
        const shuffled = [...pool].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, count);
    }

    async function startQuiz() {
        // Check attempts
        attemptsUsed = await fingerprint.getAttempts();
        
        if (attemptsUsed >= 2) {
            showNoMoreAttempts();
            return;
        }
        
        // Generate random questions
        questions = getRandomQuestions(allQuestions, 10);
        
        // Increment attempts
        await fingerprint.incrementAttempts();
        attemptsUsed++;
        
        // Update tries display
        document.getElementById('triesLeft').textContent = 2 - attemptsUsed;
        
        // Start quiz
        document.getElementById('startScreen').classList.add('hidden');
        document.getElementById('quizScreen').classList.add('show');
        startTimer();
        loadQuestion();
    }

    function showNoMoreAttempts() {
        document.getElementById('startScreen').innerHTML = `
            <div class="quiz-card" style="text-align: center;">
                <h2 style="color: #ff0000; text-shadow: 0 0 15px #ff0000; margin-bottom: 20px;">
                    <i class="fas fa-exclamation-triangle"></i> ATTEMPTS EXHAUSTED
                </h2>
                <p style="color: white; font-size: 1.3rem; margin-bottom: 30px;">
                    You've used both your attempts for this challenge!
                </p>
                <p style="color: #00ffff; font-size: 1.1rem; margin-bottom: 30px;">
                    Thank you for participating in PB DAYS: Pulse Edition!
                </p>
                <a href="https://pinkblue.in" class="btn-3d" target="_blank">
                    <i class="fas fa-shopping-cart"></i> EXPLORE PRODUCTS
                </a>
            </div>
        `;
    }

    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            updateTimerDisplay();
            
            if (timeLeft <= 0) {
                clearInterval(timer);
                endQuiz();
            }
        }, 1000);
    }

    function updateTimerDisplay() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        document.getElementById('timer').innerHTML = 
            `<i class="fas fa-clock"></i> ${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    function loadQuestion() {
        const question = questions[currentQuestion];
        document.getElementById('questionNumber').textContent = `Question ${currentQuestion + 1} of ${questions.length}`;
        document.getElementById('questionText').textContent = question.question;
        
        const optionsContainer = document.getElementById('optionsContainer');
        optionsContainer.innerHTML = '';
        
        question.options.forEach((option, index) => {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option-3d';
            optionDiv.onclick = () => selectAnswer(index);
            optionDiv.innerHTML = `
                <span style="color: #00ffff; font-weight: bold; margin-right: 15px;">${String.fromCharCode(65 + index)}</span>
                ${option}
            `;
            optionsContainer.appendChild(optionDiv);
        });
        
        updateProgress();
        selectedAnswer = null;
        document.getElementById('nextBtn').disabled = true;
    }

    function selectAnswer(index) {
        const options = document.querySelectorAll('.option-3d');
        options.forEach(option => option.classList.remove('selected'));
        options[index].classList.add('selected');
        
        selectedAnswer = index;
        document.getElementById('nextBtn').disabled = false;
    }

    function nextQuestion() {
        if (selectedAnswer === null) return;
        
        const question = questions[currentQuestion];
        const options = document.querySelectorAll('.option-3d');
        
        // Show correct/incorrect answers
        options.forEach((option, index) => {
            if (index === question.correct) {
                option.classList.add('correct');
            } else if (index === selectedAnswer && index !== question.correct) {
                option.classList.add('incorrect');
            }
        });
        
        if (selectedAnswer === question.correct) {
            score++;
        }
        
        setTimeout(() => {
            currentQuestion++;
            if (currentQuestion < questions.length) {
                loadQuestion();
            } else {
                endQuiz();
            }
        }, 1500);
    }

    function updateProgress() {
        const progress = ((currentQuestion + 1) / questions.length) * 100;
        document.getElementById('progressBar').style.width = progress + '%';
    }

    function endQuiz() {
        clearInterval(timer);
        
        document.getElementById('quizScreen').classList.add('hidden');
        document.getElementById('resultsScreen').classList.add('show');
        
        displayResults();
    }

    function displayResults() {
        const percentage = (score / questions.length) * 100;
        document.getElementById('scoreDisplay').textContent = `${score}/${questions.length} (${percentage.toFixed(0)}%)`;
        
        const resultsTitle = document.getElementById('resultsTitle');
        const rewardText = document.getElementById('rewardText');
        const couponCode = document.getElementById('couponCode');
        const restartBtn = document.getElementById('restartBtn');
        
        // Update restart button based on remaining attempts
        if (attemptsUsed >= 2) {
            restartBtn.style.display = 'none';
        }
        
        // Reward system based on score
        if (score >= 9) {
            resultsTitle.textContent = 'LEGENDARY PERFORMANCE!';
            rewardText.textContent = 'Outstanding! SpeedEndo Calcipro Rotary Files worth â‚¹1250 FREE with minimum purchase of â‚¹4999!';
            couponCode.textContent = 'XML5KZ';
        } else if (score >= 7) {
            resultsTitle.textContent = 'EXCELLENT MASTERY!';
            rewardText.textContent = 'Fantastic! You\'ve unlocked 10% PB Cashback on your purchase!';
            couponCode.textContent = 'ZYXW10';
        } else if (score === 6) {
            resultsTitle.textContent = 'GREAT KNOWLEDGE!';
            rewardText.textContent = 'Well done! You\'ve won a FREE Flitt Burs Pack of 10 worth â‚¹499!';
            couponCode.textContent = 'FLXMGH';
        } else if (score >= 4) {
            resultsTitle.textContent = 'SOLID EFFORT!';
            rewardText.textContent = 'Good work! You\'ve earned 10% PB Cashback on your next order!';
            couponCode.textContent = 'XMFHUI';
        } else {
            resultsTitle.textContent = 'KEEP LEARNING!';
            rewardText.textContent = 'Every expert was once a beginner! Here\'s a Flat 5% Off to get you started!';
            couponCode.textContent = '5XMHY';
        }
    }

    function copyCoupon() {
        const couponCode = document.getElementById('couponCode').textContent;
        
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(couponCode).then(() => {
                showCopySuccess();
            }).catch(() => {
                fallbackCopy(couponCode);
            });
        } else {
            fallbackCopy(couponCode);
        }
    }

    function fallbackCopy(text) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.left = "-999999px";
        textArea.style.top = "-999999px";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            showCopySuccess();
        } catch (err) {
            alert('Coupon code: ' + text + '\n\nPlease copy this code manually.');
        }
        document.body.removeChild(textArea);
    }

    function showCopySuccess() {
        // Create floating success message
        const success = document.createElement('div');
        success.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(145deg, #00ff00, #00cc00);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 10000;
            font-weight: bold;
            text-shadow: 0 0 10px #00ff00;
            box-shadow: 0 0 20px rgba(0,255,0,0.6);
            animation: slideIn 0.5s ease-out;
        `;
        success.innerHTML = '<i class="fas fa-check"></i> CODE COPIED TO CLIPBOARD!';
        document.body.appendChild(success);
        
        setTimeout(() => {
            success.style.animation = 'slideOut 0.5s ease-in forwards';
            setTimeout(() => document.body.removeChild(success), 500);
        }, 2500);
    }

    function shareQuiz() {
        const scoreText = document.getElementById('scoreDisplay').textContent;
        const couponText = document.getElementById('couponCode').textContent;
        
        // Create epic share text
        const shareText = `ðŸš€ I just DOMINATED the PB DAYS: Pulse Edition Dental Quiz!
        
âš¡ SCORE: ${scoreText}
ðŸŽ REWARD: ${couponText}

ðŸ¦· Think you can beat my score? Take the challenge!
ðŸ”¥ Epic rewards await dental masters!

#PBDays #PulseEdition #DentalChallenge #PinkBlue`;
        
        if (navigator.share) {
            navigator.share({
                title: 'PB DAYS: Pulse Edition - Quiz Victory!',
                text: shareText,
                url: window.location.href
            }).catch(err => {
                // Fallback if native sharing fails
                copyToClipboard(shareText);
            });
        } else {
            copyToClipboard(shareText);
        }
    }

    function copyToClipboard(text) {
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(text).then(() => {
                alert('ðŸŽ‰ Victory message copied! Share it with your friends!');
            });
        } else {
            alert('Share this victory message:\n\n' + text);
        }
    }

    async function restartQuiz() {
        // Check if attempts remaining
        const currentAttempts = await fingerprint.getAttempts();
        if (currentAttempts >= 2) {
            alert('No more attempts remaining!');
            return;
        }
        
        // Reset quiz state
        currentQuestion = 0;
        score = 0;
        timeLeft = 300;
        selectedAnswer = null;
        
        document.getElementById('resultsScreen').classList.add('hidden');
        document.getElementById('startScreen').classList.add('show');
        document.getElementById('quizScreen').classList.add('hidden');
        clearInterval(timer);
        
        // Update tries display
        document.getElementById('triesLeft').textContent = 2 - currentAttempts;
    }

    // Initialize quiz on page load
    window.addEventListener('load', async function() {
        // Update tries display
        const attempts = await fingerprint.getAttempts();
        document.getElementById('triesLeft').textContent = Math.max(0, 2 - attempts);
        
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                0% { transform: translateX(100%); opacity: 0; }
                100% { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                0% { transform: translateX(0); opacity: 1; }
                100% { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    });

    // Prevent cheating
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', function(e) {
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
            e.preventDefault();
        }
    });
</script>
